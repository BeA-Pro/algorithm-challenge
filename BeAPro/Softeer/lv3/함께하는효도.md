## ğŸ”— ë¬¸ì œ ë§í¬
[í•¨ê»˜í•˜ëŠ” íš¨ë„](https://softeer.ai/practice/7727)

## ğŸ’» ì½”ë“œ
```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.*;

class Pos{
    int x,y;
    Pos(int x, int y){
        this.x = x;
        this.y = y;
    }
}

public class Lv3_í•¨ê»˜í•˜ëŠ”íš¨ë„ {
    static int n,m;
    static ArrayList<Pos> pos = new ArrayList<>();
    static int[][] cost;
    static boolean[][] visit;
    static int[] dy = {-1,1,0,0};
    static int[] dx = {0,0,-1,1};
    static int answer = 0;

    static void dfs(int pos_idx, int length, int cur_x, int cur_y, int total){
        visit[cur_x][cur_y] = true;
        total+=cost[cur_x][cur_y];
        if(length == 3){ // ê¸¸ì´ê°€ 3ì¸ ê²½ìš°
            if(pos_idx == pos.size()-1) answer = Math.max(total,answer); // ë§Œì•½ ë§ˆì§€ë§‰ ì‹œì‘ ìœ„ì¹˜ë¼ë©´ ê°’ ê°±ì‹ 
            else dfs(pos_idx + 1, 0, pos.get(pos_idx+1).x, pos.get(pos_idx+1).y, total); // ì•„ë‹ˆë¼ë©´ ë‹¤ìŒ ì‹œì‘ ìœ„ì¹˜ì—ì„œ ì¶œë°œ
            visit[cur_x][cur_y] = false;
            return;
        }

        boolean flag = false;

        for(int i=0;i<4;i++){
            int ny = cur_y + dy[i];
            int nx = cur_x + dx[i];
            if(0 <= ny && ny < n && 0 <= nx && nx < n && !visit[nx][ny]){
                flag = true;
                dfs(pos_idx, length + 1, nx, ny, total);
            }
        }

        if(!flag){ // ì›€ì§ì´ì§€ ëª»í•˜ëŠ” ê²½ìš°
            if(pos_idx == pos.size()-1) answer = Math.max(total,answer);
            else dfs(pos_idx + 1, 0, pos.get(pos_idx+1).x, pos.get(pos_idx+1).y, total);
        }
        visit[cur_x][cur_y] = false;
    }

    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        String[] input = br.readLine().split(" ");
        n = Integer.parseInt(input[0]);
        m = Integer.parseInt(input[1]);
        cost = new int[n][n];
        visit = new boolean[n][n];

        for(int i=0;i<n;i++){
            input = br.readLine().split(" ");
            for(int j=0;j<n;j++) cost[i][j] = Integer.parseInt(input[j]);
        }

        for(int i=0;i<m;i++){
            input = br.readLine().split(" ");
            pos.add(new Pos(Integer.parseInt(input[0]) - 1,Integer.parseInt(input[1]) - 1));
        }

        dfs(0,0,pos.get(0).x,pos.get(0).y,0);
        System.out.println(answer);
    }
}

```

## ğŸ“ í•´ì„¤

mì˜ ìµœëŒ“ê°’ì´ 3ì´ê³  ê¸¸ì´ê°€ ê° ì‹œì‘ì ì—ì„œ ê¸¸ì´ 3ê¹Œì§€ë§Œ ì´ë™ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
ë”°ë¼ì„œ ë‹¨ìˆœí•˜ê²Œ ëª¨ë“  ê²½ìš°ì˜ ìˆ˜ë¥¼ ë”°ì ¸ë³´ë©´ `3(ì‹œì‘ ì§€ì ì˜ ìˆ˜) * 4(í˜„ì¬ ìœ„ì¹˜ì—ì„œ ì´ë™ ê°€ëŠ¥í•œ ìˆ˜. ìƒ í•˜ ì¢Œ ìš°)^3(ê¸¸ì´)`ì…ë‹ˆë‹¤.
ì´ ìˆ˜ëŠ” ì¶©ë¶„íˆ ê³„ì‚° ê°€ëŠ¥í•œ ìˆ«ìì´ë¯€ë¡œ dfsë¥¼ í†µí•´ í•´ê²°í•˜ì˜€ìŠµë‹ˆë‹¤.

ì£¼ì˜ í•´ì•¼ í•  ì ì€ ë” ì´ìƒ ì›€ì§ì´ì§€ ëª»í•˜ëŠ” ê²½ìš°ë„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤.

```java
for(int i=0;i<4;i++){
  int ny = cur_y + dy[i];
  int nx = cur_x + dx[i];
  if(0 <= ny && ny < n && 0 <= nx && nx < n && !visit[nx][ny]){
      flag = true;
      dfs(pos_idx, length + 1, nx, ny, total);
  }
}

if(!flag){ // ì›€ì§ì´ì§€ ëª»í•˜ëŠ” ê²½ìš°
  if(pos_idx == pos.size()-1) answer = Math.max(total,answer);
  else dfs(pos_idx + 1, 0, pos.get(pos_idx+1).x, pos.get(pos_idx+1).y, total);
}
visit[cur_x][cur_y] = false;
```
í˜„ì¬ ì‹œì‘ì ì—ì„œ 3ë§Œí¼ ì›€ì§ì´ì§€ ëª»í•˜ëŠ” ê²½ìš°, ë§ˆì§€ë§‰ ì‹œì‘ì ì´ë¼ë©´ ë‹µì„ êµ¬í•˜ê³  ì•„ë‹ˆë¼ë©´ ë‹¤ìŒ ì‹œì‘ì ì—ì„œ 3ë§Œí¼ ì›€ì§ì…ë‹ˆë‹¤.