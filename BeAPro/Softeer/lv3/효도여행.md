## ğŸ”— ë¬¸ì œ ë§í¬
[íš¨ë„ì—¬í–‰](hhttps://softeer.ai/practice/7649)

## ğŸ’» ì½”ë“œ
```java
import java.util.*;
import java.io.*;

class Info1{
    char alph;
    int to;
    Info1(int to, char alph){
        this.to = to;
        this.alph = alph;
    }
}

public class Main {
    static ArrayList<ArrayList<Info1>> graph =  new ArrayList<ArrayList<Info1>>();
    static ArrayList<Character> history = new ArrayList<>();
    static int n, m;
    static char [] route;
    static int answer = 0;
    static boolean[] check;
    static int[][] dp;

    static void dfs(int cur,int len,char c){
        check[cur] = true;

        if(cur!=1){
            for(int i=1;i<=m;i++){
                if(c == route[i-1]) dp[i][len] = dp[i-1][len -1] + 1;
                else dp[i][len] = Math.max(dp[i][len-1], dp[i-1][len]);
                answer = Math.max(answer,dp[i][len]);
            }
        }


        for(Info1 i : graph.get(cur)){
            if(!check[i.to]){
                check[i.to] = true;
                dfs(i.to,len+1,i.alph);
            }
        }


    }

    public static void main(String[] args) throws IOException{
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        String[] input = br.readLine().split(" ");
        n = Integer.parseInt(input[0]);
        m = Integer.parseInt(input[1]);
        route = br.readLine().toCharArray();

        for(int i=0;i<=n;i++) graph.add(new ArrayList<Info1>());
        check = new boolean[n+1];
        dp = new int[m+1][n+1];
        int a,b;
        char c;
        for(int i=0;i<n-1;i++){
            input=br.readLine().split(" ");
            a = Integer.parseInt(input[0]);
            b = Integer.parseInt(input[1]);
            c = input[2].charAt(0);
            graph.get(a).add(new Info1(b,c));
            graph.get(b).add(new Info1(a,c));
        }
        dfs(1,0,' ');
        System.out.println(answer);

    }
}

```

## ğŸ“ í•´ì„¤

ì´ ë¬¸ì œëŠ” dfsë¥¼ ëŒë©´ì„œ LCSë¥¼ êµ¬í•˜ëŠ” ë¬¸ì œì…ë‹ˆë‹¤.
ì²˜ìŒì—ëŠ” ê·¸ë˜í”„ë¥¼ ëŒë©´ì„œ ë¬¸ìë¥¼ ì €ì¥í•˜ì˜€ê³ , ë¦¬í”„ë…¸ë“œì— ë„ì°©í•œ ê²½ìš° ì €ì¥í•œ ë¬¸ìë“¤ê³¼ `S`ë¥¼ ë¹„êµí•˜ì—¬ LCSë¥¼ êµ¬í•˜ì˜€ìŠµë‹ˆë‹¤.
```java
    if(!leaf){
        int[][] LCS = new int [m+1][history.size() + 1];
        int temp = 0;
        for(int i=1;i<=m;i++){
            for(int j=1;j<=history.size();j++){
                if(route[i-1] == history.get(j-1)) LCS[i][j] = LCS[i-1][j-1] + 1;
                else LCS[i][j] = Math.max(LCS[i-1][j], LCS[i][j-1]);
                temp = Math.max(temp, LCS[i][j]);
            }
        }
        answer = Math.max(answer, temp);
    }
```
ì´ ê²½ìš° ë¦¬í”„ë…¸ë“œê¹Œì§€ ë„ë‹¬í•˜ëŠ”ë° ìµœëŒ€ N, ì €ì¥í•œ ë¬¸ìì—´ì˜ ê¸¸ì´ ìµœëŒ€ N, ì£¼ì–´ì§„ `S`ì˜ ìµœëŒ€ ê¸¸ì´ Mìœ¼ë¡œ O(N^2 * M)ì´ ê±¸ë¦½ë‹ˆë‹¤.
N,M ëª¨ë‘ ìµœëŒ“ê°’ì´ 5000ìœ¼ë¡œ ê³„ì‚°í•  ìˆ˜ ì—†ëŠ” í° ê²½ìš°ì˜ ìˆ˜ ì…ë‹ˆë‹¤.

ì§ê´€ì ìœ¼ë¡œ O(N * M)ì— êµ¬í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì€ ì•Œì•˜ìœ¼ë‚˜ ë°©ë²•ì´ ë– ì˜¤ë¥´ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
ì§ˆë¬¸ ë³´ë©´ì„œ dfsë¥¼ ë„ëŠ” ë™ì‹œì— LCSë¥¼ êµ¬í•´ì•¼ í•˜ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆê³  ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì§°ìŠµë‹ˆë‹¤.

```java

  static void dfs(int cur,int len,char c){
      check[cur] = true;
      
      if(cur!=1){
          // LCS êµ¬í•˜ê¸°
          for(int i=1;i<=m;i++){
              if(c == route[i-1]) dp[i][len] = dp[i-1][len -1] + 1;
              else dp[i][len] = Math.max(dp[i][len-1], dp[i-1][len]);
              answer = Math.max(answer,dp[i][len]);
          }
      }


      for(Info1 i : graph.get(cur)){
          if(!check[i.to]){
              check[i.to] = true;
              dfs(i.to,len+1,i.alph);
          }
      }
  }
```
ì‹œì‘ ë…¸ë“œë¥¼ ì œì™¸í•˜ê³  ê° ë…¸ë“œë¥¼ ë°©ë¬¸ í•  ë•Œ, ê·¸ ë…¸ë“œë¡œ ê°€ëŠ”ë° ì–»ëŠ” ë¬¸ìì™€ í˜„ì¬ ë…¸ë“œì˜ ê¹Šì´(ì—¬ê¸°ì„œëŠ” ì–»ì€ ë¬¸ìì˜ ê¸¸ì´ì´ê¸°ë„ í•˜ê¸° ë•Œë¬¸ì— `len`ìœ¼ë¡œ í‘œí˜„í–ˆìŠµë‹ˆë‹¤.)ë¥¼ ì´ìš©í•˜ì—¬ LCSë¥¼ êµ¬í•˜ì˜€ìŠµë‹ˆë‹¤.

ì´ë ‡ê²Œ í•˜ë©´ O(N*M)ì— ì£¼ì–´ì§„ ë¬¸ì œë¥¼ í•´ê²° í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë‚œì´ë„ê°€ ë†’ì§€ëŠ” ì•Šì•˜ì§€ë§Œ ìƒë‹¹í•œ ì„¼ìŠ¤ê°€ í•„ìš”í•œ ë¬¸ì œì˜€ìŠµë‹ˆë‹¤.